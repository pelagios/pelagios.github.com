define(["jquery"],function(e){(function(e){e.PaginationCalculator=function(e,t){this.maxentries=e,this.opts=t},e.extend(e.PaginationCalculator.prototype,{numPages:function(){return Math.ceil(this.maxentries/this.opts.items_per_page)},getInterval:function(e){var t=Math.floor(this.opts.num_display_entries/2),n=this.numPages(),r=n-this.opts.num_display_entries,i=e>t?Math.max(Math.min(e-t,r),0):0,s=e>t?Math.min(e+t+this.opts.num_display_entries%2,n):Math.min(this.opts.num_display_entries,n);return{start:i,end:s}}}),e.PaginationRenderers={},e.PaginationRenderers.defaultRenderer=function(t,n){this.maxentries=t,this.opts=n,this.pc=new e.PaginationCalculator(t,n)},e.extend(e.PaginationRenderers.defaultRenderer.prototype,{createLink:function(t,n,r){var i,s=this.pc.numPages();return t=t<0?0:t<s?t:s-1,r=e.extend({text:t+1,classes:""},r||{}),t==n?i=e("<span class='current'>"+r.text+"</span>"):i=e("<a>"+r.text+"</a>").attr("href",this.opts.link_to.replace(/__id__/,t)),r.classes&&i.addClass(r.classes),i.data("page_id",t),i},appendRange:function(e,t,n,r,i){var s;for(s=n;s<r;s++)this.createLink(s,t,i).appendTo(e)},getLinks:function(t,n){var r,i,s=this.pc.getInterval(t),o=this.pc.numPages(),u=e("<div class='pagination'></div>");return this.opts.prev_text&&(t>0||this.opts.prev_show_always)&&u.append(this.createLink(t-1,t,{text:this.opts.prev_text,classes:"prev"})),s.start>0&&this.opts.num_edge_entries>0&&(i=Math.min(this.opts.num_edge_entries,s.start),this.appendRange(u,t,0,i,{classes:"sp"}),this.opts.num_edge_entries<s.start&&this.opts.ellipse_text&&e("<span>"+this.opts.ellipse_text+"</span>").appendTo(u)),this.appendRange(u,t,s.start,s.end),s.end<o&&this.opts.num_edge_entries>0&&(o-this.opts.num_edge_entries>s.end&&this.opts.ellipse_text&&e("<span>"+this.opts.ellipse_text+"</span>").appendTo(u),r=Math.max(o-this.opts.num_edge_entries,s.end),this.appendRange(u,t,r,o,{classes:"ep"})),this.opts.next_text&&(t<o-1||this.opts.next_show_always)&&u.append(this.createLink(t+1,t,{text:this.opts.next_text,classes:"next"})),e("a",u).click(n),u}}),e.fn.pagination=function(t,n){function u(t){t.preventDefault();var n,r=e(t.target).data("page_id"),i=a(r);return i||t.stopPropagation(),i}function a(e){r.data("current_page",e),s=i.getLinks(e,u),r.empty(),s.appendTo(r);var t=n.callback(e,r);return t}n=e.extend({items_per_page:10,num_display_entries:11,current_page:0,num_edge_entries:0,link_to:"#",prev_text:"Prev",next_text:"Next",ellipse_text:"...",prev_show_always:!0,next_show_always:!0,renderer:"defaultRenderer",show_if_single_page:!1,load_first_page:!0,callback:function(){return!1}},n||{});var r=this,i,s,o;o=parseInt(n.current_page),r.data("current_page",o),t=!t||t<0?1:t,n.items_per_page=!n.items_per_page||n.items_per_page<0?1:n.items_per_page;if(!e.PaginationRenderers[n.renderer])throw new ReferenceError("Pagination renderer '"+n.renderer+"' was not found in jQuery.PaginationRenderers object.");i=new e.PaginationRenderers[n.renderer](t,n);var f=new e.PaginationCalculator(t,n),l=f.numPages();r.bind("setPage",{numPages:l},function(e,t){if(t>=0&&t<e.data.numPages)return a(t),!1}),r.bind("prevPage",function(t){var n=e(this).data("current_page");return n>0&&a(n-1),!1}),r.bind("nextPage",{numPages:l},function(t){var n=e(this).data("current_page");return n<t.data.numPages-1&&a(n+1),!1}),s=i.getLinks(o,u),r.empty(),(l>1||n.show_if_single_page)&&s.appendTo(r),n.load_first_page&&n.callback(o,r)}})(jQuery)})